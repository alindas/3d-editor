(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"/hhS":function(e,t,r){"use strict";var a=r("vDqi"),i=r.n(a),n=r("dy28"),s=i.a.create({baseURL:n["a"],timeout:5e3});i.a.defaults.withCredentials=!1,s.interceptors.request.use((e=>e),(e=>Promise.reject(e))),s.interceptors.response.use((e=>e.data),(e=>Promise.reject(e))),t["a"]=s},VupQ:function(e,t,r){e.exports={"stage-wrapper":"stage-wrapper___1NG9D",container:"container___3yX3I",main:"main___13jFG","control-panel":"control-panel___37B8q","blank-wrapper":"blank-wrapper___3p0b3","blank-msg":"blank-msg___3_Zyt"}},W15n:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("Womt"),i=r("G1Ma"),n=r("6dJA");class s extends i["b"]{constructor(e,t,r,s){super(),this.renderScene=t,this.renderCamera=r,this.selectedObjects=void 0!==s?s:[],this.visibleEdgeColor=new a["Color"](1,1,1),this.hiddenEdgeColor=new a["Color"](.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new a["Vector2"](e.x,e.y):new a["Vector2"](256,256);var l=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new a["WebGLRenderTarget"](this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new a["MeshDepthMaterial"],this.depthMaterial.side=a["DoubleSide"],this.depthMaterial.depthPacking=a["RGBADepthPacking"],this.depthMaterial.blending=a["NoBlending"],this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=a["DoubleSide"],this.prepareMaskMaterial.fragmentShader=h(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new a["WebGLRenderTarget"](this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new a["WebGLRenderTarget"](l,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new a["WebGLRenderTarget"](l,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new a["WebGLRenderTarget"](Math.round(l/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new a["WebGLRenderTarget"](l,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new a["WebGLRenderTarget"](Math.round(l/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;var u=4,d=4;this.separableBlurMaterial1=this.getSeperableBlurMaterial(u),this.separableBlurMaterial1.uniforms["texSize"].value.set(l,o),this.separableBlurMaterial1.uniforms["kernelRadius"].value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(d),this.separableBlurMaterial2.uniforms["texSize"].value.set(Math.round(l/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms["kernelRadius"].value=d,this.overlayMaterial=this.getOverlayMaterial(),void 0===n["a"]&&console.error("THREE.OutlinePass relies on CopyShader");var c=n["a"];function h(e,t){var r=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,r+"DepthToViewZ")}this.copyUniforms=a["UniformsUtils"].clone(c.uniforms),this.copyUniforms["opacity"].value=1,this.materialCopy=new a["ShaderMaterial"]({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:a["NoBlending"],depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new a["Color"],this.oldClearAlpha=1,this.fsQuad=new i["a"](null),this.tempPulseColor1=new a["Color"],this.tempPulseColor2=new a["Color"],this.textureMatrix=new a["Matrix4"]}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);var r=Math.round(e/this.downSampleRatio),a=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,a),this.renderTargetBlurBuffer1.setSize(r,a),this.renderTargetEdgeBuffer1.setSize(r,a),this.separableBlurMaterial1.uniforms["texSize"].value.set(r,a),r=Math.round(r/2),a=Math.round(a/2),this.renderTargetBlurBuffer2.setSize(r,a),this.renderTargetEdgeBuffer2.setSize(r,a),this.separableBlurMaterial2.uniforms["texSize"].value.set(r,a)}changeVisibilityOfSelectedObjects(e){var t=this._visibilityCache;function r(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(var a=0;a<this.selectedObjects.length;a++){var i=this.selectedObjects[a];i.traverse(r)}}changeVisibilityOfNonSelectedObjects(e){var t=this._visibilityCache,r=[];function a(e){e.isMesh&&r.push(e)}for(var i=0;i<this.selectedObjects.length;i++){var n=this.selectedObjects[i];n.traverse(a)}function s(a){if(a.isMesh||a.isSprite){for(var i=!1,n=0;n<r.length;n++){var s=r[n].id;if(s===a.id){i=!0;break}}if(!1===i){var l=a.visible;!1!==e&&!0!==t.get(a)||(a.visible=e),t.set(a,l)}}else(a.isPoints||a.isLine||a.isTransformControls)&&(!0===e?a.visible=t.get(a):(t.set(a,a.visible),a.visible=e))}this.renderScene.traverse(s)}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,r,a,i){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();var n=e.autoClear;e.autoClear=!1,i&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var l=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms["cameraNearFar"].value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms["depthTexture"].value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms["textureMatrix"].value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=l,this.fsQuad.material=this.materialCopy,this.copyUniforms["tDiffuse"].value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var o=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(o),this.tempPulseColor2.multiplyScalar(o)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms["maskTexture"].value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms["texSize"].value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms["visibleEdgeColor"].value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms["hiddenEdgeColor"].value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms["colorTexture"].value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms["direction"].value=s.BlurDirectionX,this.separableBlurMaterial1.uniforms["kernelRadius"].value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms["colorTexture"].value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms["direction"].value=s.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms["colorTexture"].value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms["direction"].value=s.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms["colorTexture"].value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms["direction"].value=s.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms["maskTexture"].value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms["edgeTexture1"].value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms["edgeTexture2"].value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms["patternTexture"].value=this.patternTexture,this.overlayMaterial.uniforms["edgeStrength"].value=this.edgeStrength,this.overlayMaterial.uniforms["edgeGlow"].value=this.edgeGlow,this.overlayMaterial.uniforms["usePatternTexture"].value=this.usePatternTexture,i&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms["tDiffuse"].value=r.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new a["ShaderMaterial"]({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new a["Vector2"](.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\t\t\t\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new a["ShaderMaterial"]({uniforms:{maskTexture:{value:null},texSize:{value:new a["Vector2"](.5,.5)},visibleEdgeColor:{value:new a["Vector3"](1,1,1)},hiddenEdgeColor:{value:new a["Vector3"](1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new a["ShaderMaterial"]({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new a["Vector2"](.5,.5)},direction:{value:new a["Vector2"](.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new a["ShaderMaterial"]({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:a["AdditiveBlending"],depthTest:!1,depthWrite:!1,transparent:!0})}}s.BlurDirectionX=new a["Vector2"](1,0),s.BlurDirectionY=new a["Vector2"](0,1)},dy28:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var a="http://192.168.186.211:8848/",i="http://192.168.186.211:8888/"},"kOe+":function(e,t,r){"use strict";r.r(t);var a=r("tJVT"),i=r("Ty5D"),n=r("9kvl"),s=r("q1tI"),l=r("LvDl"),o=r("Womt"),u=r("RyHr"),d=r("bBhY"),c=r("Mtn/"),h=r("k+my"),f=r("Ng1w"),v=r("VupQ"),g=r.n(v),m=r("W15n"),p=r("z0WU"),x=(r("sktn"),r("nKUr"));function b(){return Object(x["jsxs"])("div",{className:"content",children:[Object(x["jsx"])("div",{className:"btn"}),Object(x["jsx"])("div",{className:"btn"}),Object(x["jsx"])("div",{className:"btn"}),Object(x["jsx"])("div",{className:"btn"}),Object(x["jsx"])("div",{className:"square"})]})}var M,T,w,S,B,C,y,j,k,O,D,E,P,_=e=>{var t;return Object(x["jsxs"])("div",{className:g.a["blank-wrapper"],children:[Object(x["jsx"])(b,{}),Object(x["jsx"])("h1",{className:g.a["blank-msg"],children:null!==(t=e.msg)&&void 0!==t?t:"\u7a7a\u767d\u9875"})]})},R=_,V=r("/hhS"),U=r("dy28"),z=r("hT7A"),N=.1,W=2e4,G=10,A=1e4,L=new o["Vector2"],F=!0,Q={},I=new o["Group"];function H(){C=new h["a"](M,S),y=new m["a"](new o["Vector2"](D,E),M,S),y.edgeStrength=2.5,y.edgeGlow=1,y.usePatternTexture=!1,y.edgeThickness=1,y.downSampleRatio=2,y.pulsePeriod=0,y.visibleEdgeColor.set(3801087),y.clear=!0,j=new f["a"](d["a"]),j.uniforms.resolution.value.set(1/D,1/E),B=new c["a"](k),B.addPass(C),B.addPass(y),B.addPass(j)}function X(){var e;null!==(e=B)&&void 0!==e&&e.render?B.render():k.render(M,S),T.update()}function q(){window.TWEEN.update(),X(),window.requestAnimationFrame(q)}function Y(e){var t=Object(s["useState"])("\u52a0\u8f7d\u4e2d.."),r=Object(a["a"])(t,2),n=r[0],d=r[1],c=Object(i["l"])(),h=c.project,f=e.dispatch,v=e.sceneModel,m=v.selectedModel,b=v.outlinePassModel,C=Object(s["useRef"])(null);function _(){var e,t,r,i,n,s,d;M=new o["Scene"],M.background=new o["Color"](3355443),M.add(new o["GridHelper"](600,20,0)),w=new o["Raycaster"],D=C.current.clientWidth,E=C.current.clientHeight,O=Object(p["b"])(C.current,"leftTop"),S=new o["PerspectiveCamera"](60,D/E,N,W);var c=null!==(e=null===(t=Q)||void 0===t||null===(r=t.cameraConfig)||void 0===r?void 0:r.position)&&void 0!==e?e:[43,405,365],h=Object(a["a"])(c,3),v=h[0],g=h[1],m=h[2];S.position.set(v,g,m),M.add(S),k=new o["WebGLRenderer"]({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0}),k.setPixelRatio(window.devicePixelRatio),k.setSize(D,E),0!=C.current.children.length&&C.current.removeChild(C.current.children[0]),C.current.appendChild(k.domElement),(null!==(i=Q.lightConfig)&&void 0!==i?i:[]).forEach((e=>{var t=new o[e.type];t.name=e.name,t.intensity=e.intensity,t.castShadow=e.castShadow,t.visible=e.visible,t.color.setStyle(e.color),t.position.copy((new o["Vector3"]).fromArray(e.position));var r=e.rotate.map((e=>e*Math.PI/180));t.rotation.x=r[0],t.rotation.y=r[1],t.rotation.z=r[2],M.add(t)})),H();var x=null!==(n=null===(s=Q)||void 0===s||null===(d=s.cameraConfig)||void 0===d?void 0:d.orbitControlTarget)&&void 0!==n?n:[1,192,2],b=Object(a["a"])(x,3),B=b[0],y=b[1],j=b[2];T=new u["a"](S,k.domElement),T.enableDamping=!0,T.minDistance=G,T.maxDistance=A,T.maxPolarAngle=Math.PI/2,T.target.set(B,y,j),window.scene=M,window.orbitControl=T,window.addEventListener("resize",X),window.addEventListener("resize",Object(l["debounce"])((()=>{O=Object(p["b"])(C.current,"leftTop")}),800)),window.addEventListener("mouseup",(e=>{2==e.button&&F&&f({type:"scene/updateSelectedModel",payload:null})})),k.domElement.addEventListener("mousedown",Object(l["debounce"])((()=>{F=!0,k.domElement.onmousemove=Object(l["debounce"])((()=>{F=!1}),800,{leading:!0})}),500,{leading:!0}),!0),k.domElement.addEventListener("mouseup",Object(l["debounce"])((()=>{k.domElement.onmousemove=null}),500,{leading:!0}),!0),window.requestAnimationFrame(q)}function X(){D=C.current.clientWidth,E=C.current.clientHeight,S.aspect=D/E,S.updateProjectionMatrix(),k.setSize(D,E),B.setSize(D,E),j.uniforms.resolution.value.set(1/D,1/E)}function Y(e){if(F){e.preventDefault(),e.touches?(L.x=(e.touches[0].clientX-O[0])/C.current.offsetWidth*2-1,L.y=-(e.touches[0].clientY-O[1])/C.current.offsetHeight*2+1):(L.x=(e.clientX-O[0])/C.current.offsetWidth*2-1,L.y=-(e.clientY-O[1])/C.current.offsetHeight*2+1),w.setFromCamera(L,S);var t=w.intersectObjects(I.children);t.length>0&&(f({type:"scene/updateSelectedModel",payload:t[0].object}),window.globalEnv.events.click.validate(t[0].object.id))}}return Object(s["useEffect"])((()=>("EventSource"in window?(P=new EventSource("".concat(U["b"],"test/sse/status?projectId=").concat(h)),P.onopen=()=>{console.log("Connection Success")},P.onerror=e=>{console.log("sse \u8fde\u63a5\u51fa\u9519--".concat(e))},P.onmessage=e=>{console.log("event data",e.data)},P.addEventListener("".concat(h,"-status"),(e=>{d(JSON.parse(e.data)?"":"\u9875\u9762\u672a\u5f00\u653e"),console.log(e.type+" \u4e8b\u4ef6\u5df2\u54cd\u5e94\uff0c\u6570\u636e"+e.data)}))):alert("\u5f53\u524d\u6d4f\u89c8\u5668\u5c1a\u4e0d\u652f\u6301sse \u6280\u672f\uff0c\u8bf7\u5378\u8f7d\u5b83\u5e76\u5b89\u88c5Chrome \u6d4f\u89c8\u5668\uff08\u63a8\u8350\uff09"),V["a"].get("test/exhibit?project="+h).then((e=>{var t,r,a;"no exit"===e?d("\u9875\u9762\u672a\u5f00\u653e"):(Q=e,d(""),window.loader.loadModel(null!==(t=null===(r=Q)||void 0===r||null===(a=r.modelConfig)||void 0===a?void 0:a.files)&&void 0!==t?t:[],(e=>{e.forEach((e=>{I.add(e),e.traverse((e=>{var t,r;Reflect.has(Q.interactive,null===(t=e.userData)||void 0===t?void 0:t.id)&&window.myScript.bind(e,Q.interactive[null===(r=e.userData)||void 0===r?void 0:r.id])}))}))}),{mode:"online"}))})).catch((()=>{d("\u9875\u9762\u672a\u5f00\u653e")})),()=>{"undefined"!==typeof P&&P.close()})),[]),Object(s["useEffect"])((()=>{""===n?(_(),M.add(I),k.domElement.addEventListener("mouseup",Y,!0),k.domElement.addEventListener("touchstart",Y,!1)):(Object(z["e"])(M),M=null)}),[n]),Object(s["useEffect"])((()=>{Object(p["d"])(y)||(Object(p["d"])(m)?y.selectedObjects=[]:m.isMesh?y.selectedObjects=[b]:y.selectedObjects=[m])}),[m]),""!==n?Object(x["jsx"])(R,{msg:n}):Object(x["jsx"])("div",{className:g.a["stage-wrapper"],children:Object(x["jsx"])("div",{className:g.a["container"],children:Object(x["jsx"])("div",{ref:C,className:g.a["main"]})})})}t["default"]=Object(n["a"])((e=>({sceneModel:e.scene})))(Y)},sktn:function(e,t,r){}}]);